(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"9zR4":function(e,t,i){"use strict";i.r(t),i.d(t,"DetectionsModule",(function(){return m}));var s=i("ofXK"),a=i("tyNb"),l=i("Mn71"),n=i("fXoL"),o=i("xsI5"),c=i("OaWH"),r=i("HFyB");function b(e,t){if(1&e&&(n.Ub(0,"div",7),n.Qb(1,"img",8),n.Tb()),2&e){const e=n.kc();n.Ab(1),n.rc("src",e.appService.assets("/images/ajax-loader.gif"),n.Fc)}}function d(e,t){1&e&&(n.Ub(0,"div",9),n.Mc(1,"No DATA"),n.Tb())}function p(e,t){if(1&e&&(n.Ub(0,"span"),n.Mc(1),n.Tb()),2&e){const e=n.kc().$implicit;n.Ab(1),n.Oc("+",e.behaviors_processed.length,"")}}function h(e,t){if(1&e&&(n.Ub(0,"tr"),n.Ub(1,"td"),n.Ub(2,"div",10),n.Ub(3,"div",11),n.Qb(4,"i",12),n.Tb(),n.Ub(5,"div",13),n.Mc(6),n.Qb(7,"br"),n.Kc(8,p,2,1,"span",14),n.Tb(),n.Tb(),n.Tb(),n.Ub(9,"td"),n.Ub(10,"div",15),n.Mc(11,"Tactic & technique"),n.Tb(),n.Ub(12,"div",16),n.Mc(13),n.Tb(),n.Tb(),n.Ub(14,"td"),n.Ub(15,"div",15),n.Mc(16,"Detect time"),n.Tb(),n.Ub(17,"div",17),n.Mc(18),n.lc(19,"date"),n.Tb(),n.Tb(),n.Ub(20,"td"),n.Ub(21,"div",15),n.Mc(22,"Host"),n.Tb(),n.Ub(23,"div",17),n.Mc(24),n.Tb(),n.Tb(),n.Ub(25,"td"),n.Ub(26,"div",15),n.Mc(27,"User name"),n.Tb(),n.Ub(28,"div",17),n.Mc(29),n.Tb(),n.Tb(),n.Ub(30,"td"),n.Ub(31,"div",15),n.Mc(32,"Status"),n.Tb(),n.Ub(33,"div",17),n.Mc(34),n.Tb(),n.Tb(),n.Tb()),2&e){const e=t.$implicit,i=n.kc();n.Ab(6),n.Oc("",e.max_severity_displayname," "),n.Ab(2),n.rc("ngIf",e.behaviors_processed.length>=2),n.Ab(4),n.sc("title",e.behaviors[0].tactic+" via "+e.behaviors[0].technique),n.Ab(1),n.Oc(" ",e.behaviors[0].tactic+" via "+e.behaviors[0].technique," "),n.Ab(5),n.Nc(n.nc(19,8,e.behaviors[0].timestamp,"dd MMM yyyy hh:mm a")),n.Ab(6),n.Nc(e.device.hostname),n.Ab(5),n.Nc(e.behaviors[0].user_name),n.Ab(5),n.Nc(i.formatString(e.status))}}const u=[{path:"",component:(()=>{class e{constructor(e,t,i){this._css=e,this.appService=t,this.router=i,this.detectionsFiltered=[],this.filterCol=[{title:"Severity",fields:[{label:"Critical",selected:!1,prop:"(max_severity:>=80+max_severity:<101)",count:0},{label:"High",selected:!1,prop:"(max_severity:>=60+max_severity:<80)",count:0},{label:"Medium",selected:!1,prop:"(max_severity:>=40+max_severity:<60)",count:0},{label:"Low",selected:!1,prop:"(max_severity:>=20+max_severity:<40)",count:0},{label:"Informational",selected:!1,prop:"(max_severity:>=0+max_severity:<20)",count:0}],prop:"behavior.severity"},{title:"Tactic",fields:[],prop:"behaviors.tactic"},{title:"Technique",fields:[],prop:"behaviors.technique"},{title:"Time",fields:[{label:"Last hour",selected:!1,prop:"last_behavior:>='now-1h'"},{label:"Last day",selected:!1,prop:"last_behavior:>='now-1d'"},{label:"Last week",selected:!1,prop:"last_behavior:>='now-7d'"},{label:"Last 30 days",selected:!1,prop:"last_behavior:>='now-30d'"},{label:"Last 90 days",selected:!1,prop:"last_behavior:>='now-90d'"}],prop:"last_behavior"},{title:"Status",fields:[{label:"New",selected:!1,prop:"new",count:0},{label:"In Progress",selected:!1,prop:"in_progress",count:0},{label:"True Positive",selected:!1,prop:"true_positive",count:0},{label:"False Positive",selected:!1,prop:"false_positive",count:0},{label:"Ignored",selected:!1,prop:"ignored",count:0}],prop:"status"},{title:"Triggering file",fields:[],prop:"behaviors.filename"}],this.loading=!0,this.nodata=!1,this.csvData={name:"Detections.csv",data:""},this.filterChips=[],this.filterChipTemplate=[{filter:"status:'new'",chips:[{name:"Status",values:[{label:"New"}]}]},{filter:"last_seen:>'now-{{filterByLast}}'",chips:[{name:"Hosts",values:[{label:"All"}]}]}],this._css.ready.subscribe(()=>{setTimeout(()=>{this.updateTable()},1e3)})}ngOnInit(){this.router.events.subscribe(e=>{e instanceof a.b&&setTimeout(()=>{window.scrollTo(0,0)},1e3)}),this.updateTable()}truncateSentance(e){return e.substr(0,25)+"..."}updateTable(e=null){if(this.loading=!0,this.detectionsFiltered=[],null==e&&this._css.currentDetectionFilterId>=1)switch(this._css.currentDetectionFilterId){case 2:e="status:'new'",this.filterChips=[{name:"Status",values:[{label:"New"}]}];break;case 3:this.filterChips=[{name:"Objectives",values:[{label:"All"}]}];break;case 4:this.filterChips=[{name:"Tactics",values:[{label:"All"}]}];break;case 5:this.filterChips=[{name:"Severity",values:[{label:"All"}]}]}this.nodata=!1,this._css.mostRecentDetections(0,e).subscribe(e=>{0==e.length&&(this.nodata=!0,this.loading=!1),this._css.mostRecentDetectionsSummries(e).subscribe(e=>{"error"!=e&&(this.detectionsFiltered=e,this.generateCSV(e),this.loading=!1,this.getFieldValues(e),this._css.currentDetectionFilterId>=1&&(this._css.currentDetectionFilterId=0,this.getFieldValues(e),window.scrollTo(0,0)))})})}generateCSV(e){let t="data:text/csv;charset=utf-8,";t+="Severity,Tactic & Technique,Detect Time,Host,User name,Assigned to,Status\n",t+=e.map(e=>{let t=e.max_severity_displayname+",";return t+=e.behaviors[0].tactic+" via "+e.behaviors[0].technique+",",t+=l.a.formatDate(e.behaviors[0].timestamp,"DD MMM YYYY hh:mm a")+",",t+=e.device.hostname+",",t+=e.behaviors[0].user_name+",",t+="-,",t+=l.a.allWordUppercase(e.status),t}).join("\n"),this.csvData={name:"Detections.csv",data:t}}getFieldValues(e){this.filterCol.map(e=>{e.fields.map(e=>{e.count=0})}),e.map(e=>{e.behaviors.map(e=>{let t=e.severity;t=t<20?"Informal":t>=20&&t<40?"Low":t>=40&&t<60?"Medium":t>=60&&t<80?"High":"Cirtical",this.canPush(this.filterCol[0].fields,"label",t),this.canPush(this.filterCol[1].fields,"label",e.tactic),this.canPush(this.filterCol[2].fields,"label",e.technique),this.canPush(this.filterCol[5].fields,"label",e.filename)});let t=l.a.allWordUppercase(e.status);this.canPush(this.filterCol[4].fields,"label",t)})}formatString(e){return l.a.allWordUppercase(e)}canPush(e,t,i){0==e.filter(e=>e[t].toLowerCase()==i.toLowerCase()&&(e.count=null==e.count?1:e.count+1,!0)).length&&e.push({label:i,selected:!1,count:1,prop:i})}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(o.a),n.Pb(c.a),n.Pb(a.c))},e.\u0275cmp=n.Jb({type:e,selectors:[["app-detections"]],decls:8,vars:7,consts:[[1,"container-fluid","full-page","p-0"],["addedFor","detections",1,".filter-sec",3,"totalDetections","filterCol","filterChips","csvData","filterSelection"],[1,"container-fluid"],["class","loader",4,"ngIf"],["class","nodata text-center mt-5",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],[1,"loader"],[3,"src"],[1,"nodata","text-center","mt-5"],[1,"row"],[1,"priority-icon"],[1,"fab","fa-first-order","fa-2x"],[1,"priority-data"],[4,"ngIf"],[1,"col-2-title"],[1,"col-2-data",3,"title"],[1,"col-2-data"]],template:function(e,t){1&e&&(n.Ub(0,"section",0),n.Ub(1,"filter-selection",1),n.gc("filterSelection",(function(e){return t.updateTable(e)})),n.Tb(),n.Ub(2,"section",2),n.Kc(3,b,2,1,"div",3),n.Kc(4,d,2,0,"div",4),n.Ub(5,"table",5),n.Ub(6,"tbody"),n.Kc(7,h,35,11,"tr",6),n.Tb(),n.Tb(),n.Tb(),n.Tb()),2&e&&(n.Ab(1),n.rc("totalDetections",t.detectionsFiltered.length)("filterCol",t.filterCol)("filterChips",t.filterChips)("csvData",t.csvData),n.Ab(2),n.rc("ngIf",t.loading),n.Ab(1),n.rc("ngIf",t.nodata),n.Ab(3),n.rc("ngForOf",t.detectionsFiltered))},directives:[r.a,s.m,s.l],pipes:[s.d],styles:[".full-page[_ngcontent-%COMP%]{height:100vh;overflow:auto;padding-top:1em}.loader[_ngcontent-%COMP%]{text-align:center;padding-top:2em}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:5px}.table[_ngcontent-%COMP%]   .priority-icon[_ngcontent-%COMP%]{color:#ffab00;float:left}.table[_ngcontent-%COMP%]   .priority-data[_ngcontent-%COMP%]{padding-top:5px;padding-left:15px;font-size:.8em;float:left}.table[_ngcontent-%COMP%]   .col-2-title[_ngcontent-%COMP%]{text-transform:uppercase;color:#696969;font-size:.65em}.table[_ngcontent-%COMP%]   .col-2-data[_ngcontent-%COMP%]{font-size:.8em}"]}),e})()}];let f=(()=>{class e{}return e.\u0275mod=n.Nb({type:e}),e.\u0275inj=n.Mb({factory:function(t){return new(t||e)},imports:[[a.e.forChild(u)],a.e]}),e})();var v=i("OZVm");let m=(()=>{class e{}return e.\u0275mod=n.Nb({type:e}),e.\u0275inj=n.Mb({factory:function(t){return new(t||e)},imports:[[s.b,f,v.a]]}),e})()}}]);